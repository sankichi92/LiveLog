%header.content-header
  .container-fluid
    .row.mb-3
      .col-sm-6
        %h1
          = @live.title
          曲の追加

      .col-sm-6
        %ol.breadcrumb.float-sm-right
          %li.breadcrumb-item= link_to 'Home', admin_root_path
          %li.breadcrumb-item= link_to Live.model_name.human, admin_lives_path
          %li.breadcrumb-item= link_to @live.title, admin_live_path(@live)
          %li.breadcrumb-item.active 曲の追加

%section.content
  .container-fluid
    %section.card
      = form_with model: @song, url: admin_live_songs_path, local: true do |form|
        .card-body
          = render 'shared/error_messages', errors: @song.errors

          - if @song.live.nf?
            .form-group
              = form.label :time
              = form.time_field :time, class: 'form-control'

          .form-group
            = form.label :position
            = form.number_field :position, class: 'form-control'

          .form-group
            = form.label :name
            = form.text_field :name, required: true, class: 'form-control'

          .form-group
            = form.label :artist
            = form.text_field :artist, class: 'form-control', list: 'artists'
            %datalist#artists
              - Song.artists_for_suggestion.each do |artist|
                %option{ value: artist }

          .form-check.mb-3
            = form.check_box :original, class: 'form-check-input'
            = form.label :original, class: 'form-check-label'
            %small.form-text.text-muted 京大アンプラグドのメンバーが作詞・作曲した曲の場合にチェックしてください

          .form-group
            = form.label :youtube_url
            = form.url_field :youtube_url, class: 'form-control', placeholder: 'https://www.youtube.com/watch?v=sSbqm7ZK_9s', pattern: 'https?://(www\.youtube\.com|youtu\.be)/.*'

          .form-group
            = form.label :audio
            = form.file_field :audio, direct_upload: true, accept: 'audio/mpeg', class: 'form-control-file'

          %div{ data: { controller: 'form-playings' } }
            %template{ data: { target: 'form-playings.template' } }
              = form.fields_for :playings, Playing.new, child_index: 'TEMPLATE_INDEX' do |playings_form|
                = render 'admin/songs/form_playing', form: playings_form

            = form.fields_for :playings do |playings_form|
              = render 'admin/songs/form_playing', form: playings_form

            %button.btn.btn-light{ type: 'button', data: { action: 'form-playings#addPlaying' } }= icon('fas', 'plus', 'メンバーを追加する')

          %datalist#instruments
            - Playing.insts_for_suggestion.each do |inst|
              %option{ value: inst }

        .card-footer
          = form.submit class: 'btn btn-primary'

